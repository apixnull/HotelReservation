<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <title>Book a Room</title>
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css">
    <script src="https://cdn.jsdelivr.net/npm/sweetalert2@11"></script>
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
    <style>
        body {
            background-color: #f8f9fa;
        }

        .container-full {
            display: flex;
            height: 100vh;
        }

        .room-gallery {
            flex: 1;
            overflow: hidden;
        }

        .booking-details {
            flex: 1;
            padding: 40px;
            background: white;
            display: flex;
            flex-direction: column;
            justify-content: center;
            box-shadow: -5px 0px 15px rgba(0, 0, 0, 0.1);
        }
    </style>
</head>
<body>
    <div class="container-full">
        <!-- Image Slider -->
        <div class="room-gallery">
            <div id="roomCarousel" class="carousel slide" data-bs-ride="carousel">
                <div class="carousel-inner">
                    <div class="carousel-item active">
                        <img src="@Model.Image1" class="d-block w-100" alt="Room Image 1">
                    </div>
                    <div class="carousel-item">
                        <img src="@Model.Image2" class="d-block w-100" alt="Room Image 2">
                    </div>
                </div>
                <button class="carousel-control-prev" type="button" data-bs-target="#roomCarousel" data-bs-slide="prev">
                    <span class="carousel-control-prev-icon" aria-hidden="true"></span>
                </button>
                <button class="carousel-control-next" type="button" data-bs-target="#roomCarousel" data-bs-slide="next">
                    <span class="carousel-control-next-icon" aria-hidden="true"></span>
                </button>
            </div>
        </div>

        <!-- Booking Form -->
        <div class="booking-details">
            <h2>@Model.RoomType Room</h2>
            <p>@Model.Description</p>
            <p><strong>Price per night:</strong> ₱@Model.Price</p>
            <p><strong>Max Occupancy:</strong> @Model.MaxOccupancy guests</p>
            <hr>
            <h4>Reserve Your Stay</h4>
            <form asp-controller="Booking" asp-action="Book" method="post">
                <input type="hidden" name="RoomId" value="@Model.RoomId" />
                <div class="mb-3">
                    <label class="form-label">Check-In Date</label>
                    <input id="checkInDate" name="CheckInDate" class="form-control" type="date" required>
                </div>
                <div class="mb-3">
                    <label class="form-label">Check-Out Date</label>
                    <input id="checkOutDate" name="CheckOutDate" class="form-control" type="date" required>
                </div>
                <div class="mb-3">
                    <label class="form-label">Total Price (including tax):</label>
                    <input id="totalPrice" class="form-control" readonly>
                </div>
                <button type="submit" class="btn btn-primary w-100">Proceed to Checkout</button>
            </form>
        </div>
    </div>

    <script>
        document.addEventListener("DOMContentLoaded", function () {
            const checkInInput = document.getElementById("checkInDate");
            const checkOutInput = document.getElementById("checkOutDate");
            const totalPriceInput = document.getElementById("totalPrice");
            const pricePerNight = parseFloat("@Model.Price");
            const taxRate = 0.10; // 10% tax

            function updateTotalPrice() {
                const checkIn = new Date(checkInInput.value);
                const checkOut = new Date(checkOutInput.value);
                const today = new Date();
                today.setHours(0, 0, 0, 0);

                if (checkIn < today) {
                    Swal.fire("Invalid Date", "Check-in date cannot be in the past!", "error");
                    checkInInput.value = "";
                    return;
                }
                if (checkOut <= checkIn) {
                    Swal.fire("Invalid Date", "Check-out date must be after check-in date!", "error");
                    checkOutInput.value = "";
                    return;
                }

                const nights = Math.round((checkOut - checkIn) / (1000 * 60 * 60 * 24));
                const totalCost = nights * pricePerNight;
                const totalWithTax = totalCost + (totalCost * taxRate);
                totalPriceInput.value = `₱${totalWithTax.toFixed(2)}`;
            }

            checkInInput.addEventListener("change", updateTotalPrice);
            checkOutInput.addEventListener("change", updateTotalPrice);
        });
    </script>
</body>
</html>
